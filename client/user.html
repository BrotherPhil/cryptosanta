<template name="start">
  <div class="starter-template">
  {{#if currentUser}}
    {{> go}}
  {{else}}
    {{> signup}}
  {{/if}}
  </div>
</template>

<template name="go">
  {{#if currentUser}}
  <br>
  <div class="jumbotron">
    <p class="lead">Starting your own <strong>Crypto Santa</strong> is easy, just create an event and invite some pariticpants! Events you have already created, been invited to or are participating in are displayed below</p>
    <p><a class="btn btn-primary btn-lg" href="/create" role="button">Create or manage a Crypto Santa event &raquo;</a></p>
</div>
  {{#if count santas}}
  <div class="panel">
    <div class="panel-heading"><h2 class="panel-title">Crypto Santa Events You Have Created</h2></div>
    <div class="list-group">
      {{#each santas}}
        <a href="/santa/{{_id}}" class="list-group-item">{{event}}</a>
      {{/each}}
    </div>
  </div>
  {{/if}}
  {{#if count memberships}}
  <div class="panel">
    <div class="panel-heading"><h2 class="panel-title">Crypto Santa Events You Are Part Of</h2></div>
    <div class="list-group">
      {{#each memberships}}
        <a href="/member/{{_id}}" class="list-group-item">{{santaName santa}}</a>
      {{/each}}
    </div>
  </div>
  {{/if}}
  {{#if count invites}}
  <div class="panel">
    <div class="panel-heading"><h2 class="panel-title">Crypto Santa Invites</h2></div>
    <div class="list-group">
      {{#each invites}}
        <a href="/invite/{{_id}}" class="list-group-item">{{santaName santa}}</a>
      {{/each}}
    </div>
  </div>
  {{/if}}
  {{else}}
    {{> signup}}
  {{/if}}
</template>

<template name="create">
  {{#if currentUser}}
  <div class="panel">
    <div class="panel-heading"><h2 class="panel-title">Create Crypto Santa Events</h2></div>
  </div>
  {{> quickForm collection="Santa" fields="event" id="insertSantaForm" type="insert"}}
  {{#if santas}}
  <div class="panel">
    <div class="panel-heading"><h2 class="panel-title">Crypto Santa Events You Have Created</h2></div>
    <div class="list-group">
      {{#each santas}}
        <a href="/santa/{{_id}}" class="list-group-item"><span class="col-lg-10">{{event}}</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{> quickRemoveButton collection="Santa" _id=this._id beforeRemove=beforeRemove}}</a>
      {{/each}}
    </div>
  </div>
  {{/if}}
  {{else}}
    {{> signup}}
  {{/if}}
</template>

<template name="santa">
  {{#if currentUser}}
  <div class="panel">
    <div class="panel-heading"><h2 class="panel-title">Manage Your Crypto Santa</h2></div>
  </div>
  {{> quickForm collection="Santa" fields="event" doc=this.santa id="updateSantaForm" type="update"}}
    {{#if santa.started}}
      <div class="panel">
        <div class="panel-heading"><h2 class="panel-title">Crypto Santa Started</h2></div>
        <div class="panel-body"><p>This event has already been started, so everyone can see their onion wrapping instruuctions. No more people can be added. Have fun!</p></div>
      </div>
    {{else}}
  <div class="panel">
    <div class="panel-heading"><h2 class="panel-title">Invite New Participants</h2></div>
  </div>
    {{> quickForm collection="Membership" fields="email" id="insertMembershipForm" type="insert"}}
    <div class="panel">
      <div class="panel-heading"><h2 class="panel-title">Manage Participants</h2></div>
      <ul class="list-group">
        {{#each members}}
          <div class="list-group-item {{accepted this}}"><p class="col-lg-10">{{name this}}</p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{> quickRemoveButton collection="Membership" _id=this._id}}</div>
        {{/each}}
      </ul>
    </div>
      {{#if minMembers santa._id}}
    <br>
    <div class="jumbotron">
    <p class="lead"><strong>Your Crypto Santa can be started.</strong></p>
    <p>Once you start an Event, no more participants can be added, and no more invitations can be accepted.</p>
    <p>Once you start, your pariticpants will be notified and given their Onion Wrapping Instructions. Please give everyone a chance to accept your invitiation.</p>
    <p><a class="btn btn-primary btn-lg" href="?start=YES" role="button">Start Crypto Santa!</a></p>
    </div>
      {{else}}
    <p><div class="btn btn-primary btn-lg disabled" role="button">Need at least 4 accepted participants!</div></p>
      {{/if}}
   {{/if}}
  {{else}}
    {{> signup}}
  {{/if}}
</template>

<template name="accept">
  {{#if currentUser}}
    <p><a class="btn btn-primary btn-lg" href="?accept=YES" role="button">Accept Invitation!</a></p>
  {{else}}
    {{> signup}}
  {{/if}}
</template>

<template name="member">
  {{#if currentUser}}
    {{#if santa.started}}
      <div class="panel">
        <div class="panel-heading"><h2 class="panel-title">Onion Wrapping Instructions</h2></div>
        <div class="panel-body">
        <p>Your Crypto Santa has begin, now is the time to prepare your gift!</p>
        <p>Your gift is for <strong>{{name member.onion.recipient}}</strong>, once your gift is ready, gift wrapped and labeled, you are ready to add the three layers of onion wrapping by following the instructions below</p>
        <p>While it's nice to use attactive wrapping paper to wrap your gift, it's best to use newspaper or scrap paper for the outer three laywers of wrapping</p>
        <p>Please label each layer clearly</p>
      </div>
      <div class="list-group">
      <div class="list-group-item"> 
        <span class="badge">Your Gift</span>
        <h4 class="list-group-item-heading">Recipient</h4>
        <strong class="list-group-item-text">{{name member.onion.recipient}}</strong>
        <p class="list-group-item-text">This is the person your gift is for. Wrap your present and label it for {{name member.onion.recipient}}</p>
        </div>
      <div class="list-group-item"> 
        <span class="badge">Layer 1</span>
        <h4 class="list-group-item-heading">Exit</h4>
        <strong class="list-group-item-text">{{name member.onion.exit}}</strong>
        <p class="list-group-item-text">This is the first layer of your onion wrapping. Re-wrap your wrapped present and label it for {{name member.onion.exit}}</p>
      </div>
      <div class="list-group-item"> 
        <span class="badge">Layer 2</span>
        <h4 class="list-group-item-heading">Middle</h4>
        <strong class="list-group-item-text">{{name member.onion.middle}}</strong>
        <p class="list-group-item-text">This is the second layer of your onion wrapping. Wrap again and label it for {{name member.onion.middle}}</p>
      </div>
      <div class="list-group-item"> 
        <span class="badge">Layer 3</span>
        <h4 class="list-group-item-heading">Entry</h4>
        <strong class="list-group-item-text">{{name member.onion.exit}}</strong>
        <p class="list-group-item-text">This is final outer layer of your onion wrapping. Label it for {{name member.onion.entry}}. This is the person you will give the onion wrapped gift too at your Crypto Santa event. Be discrete.</p>
      </div>
      </div>
      </div>
    {{else}}
  <div class="jumbotron">
    <h2>This Crypto Santa Event Has Not Started</h2>
    <p>When the organizer starts the event your Onion Wrapping instructions will be displayed here</p>
    <p>In the meantime, you can get your gift ready.</p>
  </div>
    {{/if}}
  {{else}}
    {{> signup}}
  {{/if}}
</template>

